{"version":3,"sources":["../../../../../nodes/Guardrails/actions/checks/keywords.ts"],"sourcesContent":["// Source: https://github.com/openai/openai-guardrails-js/blob/b9b99b4fb454f02a362c2836aec6285176ec40a8/src/checks/keywords.ts\nimport type { CreateCheckFn, GuardrailResult } from '../types';\n\ninterface KeywordsConfig {\n\tkeywords: string[];\n}\n\n/**\n * Keywords-based content filtering guardrail.\n *\n * Checks if any of the configured keywords appear in the input text.\n * Can be configured to trigger tripwires on matches or just report them.\n *\n * @param text Input text to check\n * @param config Configuration specifying keywords and behavior\n * @returns GuardrailResult indicating if tripwire was triggered\n */\nconst keywordsCheck = (text: string, config: KeywordsConfig): GuardrailResult => {\n\tconst { keywords } = config;\n\n\t// Sanitize keywords by stripping trailing punctuation\n\tconst sanitizedKeywords = keywords.map((k: string) => k.replace(/[.,!?;:]+$/, ''));\n\n\tconst validKeywords = sanitizedKeywords.filter((k: string) => k.length > 0);\n\n\tif (validKeywords.length === 0) {\n\t\treturn {\n\t\t\tguardrailName: 'keywords',\n\t\t\ttripwireTriggered: false,\n\t\t\tinfo: {\n\t\t\t\tmatchedKeywords: [],\n\t\t\t},\n\t\t};\n\t}\n\n\t// Create regex pattern with word boundaries\n\t// Escape special regex characters and join with word boundaries\n\tconst escapedKeywords = validKeywords.map((k: string) =>\n\t\tk.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'),\n\t);\n\tconst patternText = `\\\\b(?:${escapedKeywords.join('|')})\\\\b`;\n\tconst pattern = new RegExp(patternText, 'gi'); // case-insensitive, global\n\n\tconst matches: string[] = [];\n\tlet match;\n\tconst seen = new Set<string>();\n\n\t// Find all matches and collect unique ones (case-insensitive)\n\twhile ((match = pattern.exec(text)) !== null) {\n\t\tconst matchedText = match[0];\n\t\tif (!seen.has(matchedText.toLowerCase())) {\n\t\t\tmatches.push(matchedText);\n\t\t\tseen.add(matchedText.toLowerCase());\n\t\t}\n\t}\n\n\tconst tripwireTriggered = matches.length > 0;\n\n\treturn {\n\t\tguardrailName: 'keywords',\n\t\ttripwireTriggered,\n\t\tinfo: {\n\t\t\tmatchedKeywords: matches,\n\t\t},\n\t};\n};\n\nexport const createKeywordsCheckFn: CreateCheckFn<KeywordsConfig> = (config) => (input: string) =>\n\tkeywordsCheck(input, config);\n"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAiBA,MAAM,gBAAgB,CAAC,MAAc,WAA4C;AAChF,QAAM,EAAE,SAAS,IAAI;AAGrB,QAAM,oBAAoB,SAAS,IAAI,CAAC,MAAc,EAAE,QAAQ,cAAc,EAAE,CAAC;AAEjF,QAAM,gBAAgB,kBAAkB,OAAO,CAAC,MAAc,EAAE,SAAS,CAAC;AAE1E,MAAI,cAAc,WAAW,GAAG;AAC/B,WAAO;AAAA,MACN,eAAe;AAAA,MACf,mBAAmB;AAAA,MACnB,MAAM;AAAA,QACL,iBAAiB,CAAC;AAAA,MACnB;AAAA,IACD;AAAA,EACD;AAIA,QAAM,kBAAkB,cAAc;AAAA,IAAI,CAAC,MAC1C,EAAE,QAAQ,uBAAuB,MAAM;AAAA,EACxC;AACA,QAAM,cAAc,SAAS,gBAAgB,KAAK,GAAG,CAAC;AACtD,QAAM,UAAU,IAAI,OAAO,aAAa,IAAI;AAE5C,QAAM,UAAoB,CAAC;AAC3B,MAAI;AACJ,QAAM,OAAO,oBAAI,IAAY;AAG7B,UAAQ,QAAQ,QAAQ,KAAK,IAAI,OAAO,MAAM;AAC7C,UAAM,cAAc,MAAM,CAAC;AAC3B,QAAI,CAAC,KAAK,IAAI,YAAY,YAAY,CAAC,GAAG;AACzC,cAAQ,KAAK,WAAW;AACxB,WAAK,IAAI,YAAY,YAAY,CAAC;AAAA,IACnC;AAAA,EACD;AAEA,QAAM,oBAAoB,QAAQ,SAAS;AAE3C,SAAO;AAAA,IACN,eAAe;AAAA,IACf;AAAA,IACA,MAAM;AAAA,MACL,iBAAiB;AAAA,IAClB;AAAA,EACD;AACD;AAEO,MAAM,wBAAuD,CAAC,WAAW,CAAC,UAChF,cAAc,OAAO,MAAM;","names":[]}