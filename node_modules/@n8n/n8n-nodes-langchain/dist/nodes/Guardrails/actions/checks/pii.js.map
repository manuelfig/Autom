{"version":3,"sources":["../../../../../nodes/Guardrails/actions/checks/pii.ts"],"sourcesContent":["// Source: https://github.com/openai/openai-guardrails-js/blob/b9b99b4fb454f02a362c2836aec6285176ec40a8/src/checks/pii.ts\n/**\n * PII detection guardrail for sensitive text content.\n *\n * This module implements a guardrail for detecting Personally Identifiable\n * Information (PII) in text using regex patterns. It defines the config\n * schema for entity selection, output/result structures, and the async guardrail\n * check_fn for runtime enforcement.\n */\n\nimport { parseRegex } from '../../helpers/common';\nimport type { CreateCheckFn, CustomRegex } from '../types';\n\n/**\n * Supported PII entity types for detection.\n *\n * Includes global and region-specific types (US, UK, Spain, Italy, etc.).\n * These map to regex patterns for detection.\n */\n// eslint-disable-next-line no-restricted-syntax\nexport enum PIIEntity {\n\t// Global\n\tCREDIT_CARD = 'CREDIT_CARD',\n\tCRYPTO = 'CRYPTO',\n\tDATE_TIME = 'DATE_TIME',\n\tEMAIL_ADDRESS = 'EMAIL_ADDRESS',\n\tIBAN_CODE = 'IBAN_CODE',\n\tIP_ADDRESS = 'IP_ADDRESS',\n\tLOCATION = 'LOCATION',\n\tPHONE_NUMBER = 'PHONE_NUMBER',\n\tMEDICAL_LICENSE = 'MEDICAL_LICENSE',\n\n\t// USA\n\tUS_BANK_NUMBER = 'US_BANK_NUMBER',\n\tUS_DRIVER_LICENSE = 'US_DRIVER_LICENSE',\n\tUS_ITIN = 'US_ITIN',\n\tUS_PASSPORT = 'US_PASSPORT',\n\tUS_SSN = 'US_SSN',\n\n\t// UK\n\tUK_NHS = 'UK_NHS',\n\tUK_NINO = 'UK_NINO',\n\n\t// Spain\n\tES_NIF = 'ES_NIF',\n\tES_NIE = 'ES_NIE',\n\n\t// Italy\n\tIT_FISCAL_CODE = 'IT_FISCAL_CODE',\n\tIT_DRIVER_LICENSE = 'IT_DRIVER_LICENSE',\n\tIT_VAT_CODE = 'IT_VAT_CODE',\n\tIT_PASSPORT = 'IT_PASSPORT',\n\tIT_IDENTITY_CARD = 'IT_IDENTITY_CARD',\n\n\t// Poland\n\tPL_PESEL = 'PL_PESEL',\n\n\t// Singapore\n\tSG_NRIC_FIN = 'SG_NRIC_FIN',\n\tSG_UEN = 'SG_UEN',\n\n\t// Australia\n\tAU_ABN = 'AU_ABN',\n\tAU_ACN = 'AU_ACN',\n\tAU_TFN = 'AU_TFN',\n\tAU_MEDICARE = 'AU_MEDICARE',\n\n\t// India\n\tIN_PAN = 'IN_PAN',\n\tIN_AADHAAR = 'IN_AADHAAR',\n\tIN_VEHICLE_REGISTRATION = 'IN_VEHICLE_REGISTRATION',\n\tIN_VOTER = 'IN_VOTER',\n\tIN_PASSPORT = 'IN_PASSPORT',\n\n\t// Finland\n\tFI_PERSONAL_IDENTITY_CODE = 'FI_PERSONAL_IDENTITY_CODE',\n}\n\nconst allEntities = Object.values(PIIEntity);\n\nexport type PIIConfig = {\n\tentities?: PIIEntity[];\n\tcustomRegex?: CustomRegex[];\n};\n\nexport type CustomRegexConfig = {\n\tcustomRegex: CustomRegex[];\n};\n\n/**\n * Internal result structure for PII detection.\n */\ninterface PiiDetectionResult {\n\tmapping: Record<string, string[]>;\n\tanalyzerResults: PiiAnalyzerResult[];\n}\n\n/**\n * PII analyzer result structure.\n */\ninterface PiiAnalyzerResult {\n\tentityType: string;\n\ttext: string;\n}\n\nexport const PII_NAME_MAP: Record<PIIEntity, string> = {\n\t[PIIEntity.CREDIT_CARD]: 'Credit Card',\n\t[PIIEntity.CRYPTO]: 'Crypto',\n\t[PIIEntity.DATE_TIME]: 'Date Time',\n\t[PIIEntity.EMAIL_ADDRESS]: 'Email Address',\n\t[PIIEntity.IBAN_CODE]: 'IBAN Code',\n\t[PIIEntity.IP_ADDRESS]: 'IP Address',\n\t[PIIEntity.LOCATION]: 'Location',\n\t[PIIEntity.PHONE_NUMBER]: 'Phone Number',\n\t[PIIEntity.MEDICAL_LICENSE]: 'Medical License',\n\t[PIIEntity.US_BANK_NUMBER]: 'US Bank Number',\n\t[PIIEntity.US_DRIVER_LICENSE]: 'US Driver License',\n\t[PIIEntity.US_ITIN]: 'US ITIN',\n\t[PIIEntity.US_PASSPORT]: 'US Passport',\n\t[PIIEntity.US_SSN]: 'US SSN',\n\t[PIIEntity.UK_NHS]: 'UK NHS',\n\t[PIIEntity.UK_NINO]: 'UK NINO',\n\t[PIIEntity.ES_NIF]: 'ES NIF',\n\t[PIIEntity.ES_NIE]: 'ES NIE',\n\t[PIIEntity.IT_FISCAL_CODE]: 'IT Fiscal Code',\n\t[PIIEntity.IT_DRIVER_LICENSE]: 'IT Driver License',\n\t[PIIEntity.IT_VAT_CODE]: 'IT VAT Code',\n\t[PIIEntity.IT_PASSPORT]: 'IT Passport',\n\t[PIIEntity.IT_IDENTITY_CARD]: 'IT Identity Card',\n\t[PIIEntity.PL_PESEL]: 'PL PESEL',\n\t[PIIEntity.SG_NRIC_FIN]: 'SG NRIC FIN',\n\t[PIIEntity.SG_UEN]: 'SG UEN',\n\t[PIIEntity.AU_ABN]: 'AU ABN',\n\t[PIIEntity.AU_ACN]: 'AU ACN',\n\t[PIIEntity.AU_TFN]: 'AU TFN',\n\t[PIIEntity.AU_MEDICARE]: 'AU Medicare',\n\t[PIIEntity.IN_PAN]: 'IN PAN',\n\t[PIIEntity.IN_AADHAAR]: 'IN AADHAAR',\n\t[PIIEntity.IN_VEHICLE_REGISTRATION]: 'IN Vehicle Registration',\n\t[PIIEntity.IN_VOTER]: 'IN Voter',\n\t[PIIEntity.IN_PASSPORT]: 'IN Passport',\n\t[PIIEntity.FI_PERSONAL_IDENTITY_CODE]: 'FI Personal Identity Code',\n};\n\n/**\n * Default regex patterns for PII entity types.\n */\nconst DEFAULT_PII_PATTERNS: Record<PIIEntity, RegExp> = {\n\t[PIIEntity.CREDIT_CARD]: /\\b\\d{4}[-\\s]?\\d{4}[-\\s]?\\d{4}[-\\s]?\\d{4}\\b/g,\n\t[PIIEntity.CRYPTO]: /\\b[13][a-km-zA-HJ-NP-Z1-9]{25,34}\\b/g,\n\t[PIIEntity.DATE_TIME]: /\\b(0[1-9]|1[0-2])[\\/\\-](0[1-9]|[12]\\d|3[01])[\\/\\-](19|20)\\d{2}\\b/g,\n\t[PIIEntity.EMAIL_ADDRESS]: /\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Z|a-z]{2,}\\b/g,\n\t[PIIEntity.IBAN_CODE]: /\\b[A-Z]{2}[0-9]{2}[A-Z0-9]{4}[0-9]{7}([A-Z0-9]?){0,16}\\b/g,\n\t[PIIEntity.IP_ADDRESS]: /\\b(?:[0-9]{1,3}\\.){3}[0-9]{1,3}\\b/g,\n\t[PIIEntity.LOCATION]:\n\t\t/\\b[A-Za-z\\s]+(?:Street|St|Avenue|Ave|Road|Rd|Boulevard|Blvd|Drive|Dr|Lane|Ln|Place|Pl|Court|Ct|Way|Highway|Hwy)\\b/g,\n\t[PIIEntity.PHONE_NUMBER]: /\\b[\\+]?[(]?[0-9]{3}[)]?[-\\s\\.]?[0-9]{3}[-\\s\\.]?[0-9]{4,6}\\b/g,\n\t[PIIEntity.MEDICAL_LICENSE]: /\\b[A-Z]{2}\\d{6}\\b/g,\n\n\t// USA\n\t[PIIEntity.US_BANK_NUMBER]: /\\b\\d{8,17}\\b/g,\n\t[PIIEntity.US_DRIVER_LICENSE]: /\\b[A-Z]\\d{7}\\b/g,\n\t[PIIEntity.US_ITIN]: /\\b9\\d{2}-\\d{2}-\\d{4}\\b/g,\n\t[PIIEntity.US_PASSPORT]: /\\b[A-Z]\\d{8}\\b/g,\n\t[PIIEntity.US_SSN]: /\\b\\d{3}-\\d{2}-\\d{4}\\b|\\b\\d{9}\\b/g,\n\n\t// UK\n\t[PIIEntity.UK_NHS]: /\\b\\d{3} \\d{3} \\d{4}\\b/g,\n\t[PIIEntity.UK_NINO]: /\\b[A-Z]{2}\\d{6}[A-Z]\\b/g,\n\n\t// Spain\n\t[PIIEntity.ES_NIF]: /\\b[A-Z]\\d{8}\\b/g,\n\t[PIIEntity.ES_NIE]: /\\b[A-Z]\\d{8}\\b/g,\n\n\t// Italy\n\t[PIIEntity.IT_FISCAL_CODE]: /\\b[A-Z]{6}\\d{2}[A-Z]\\d{2}[A-Z]\\d{3}[A-Z]\\b/g,\n\t[PIIEntity.IT_DRIVER_LICENSE]: /\\b[A-Z]{2}\\d{7}\\b/g,\n\t[PIIEntity.IT_VAT_CODE]: /\\bIT\\d{11}\\b/g,\n\t[PIIEntity.IT_PASSPORT]: /\\b[A-Z]{2}\\d{7}\\b/g,\n\t[PIIEntity.IT_IDENTITY_CARD]: /\\b[A-Z]{2}\\d{7}\\b/g,\n\n\t// Poland\n\t[PIIEntity.PL_PESEL]: /\\b\\d{11}\\b/g,\n\n\t// Singapore\n\t[PIIEntity.SG_NRIC_FIN]: /\\b[A-Z]\\d{7}[A-Z]\\b/g,\n\t[PIIEntity.SG_UEN]: /\\b\\d{8}[A-Z]\\b|\\b\\d{9}[A-Z]\\b/g,\n\n\t// Australia\n\t[PIIEntity.AU_ABN]: /\\b\\d{2} \\d{3} \\d{3} \\d{3}\\b/g,\n\t[PIIEntity.AU_ACN]: /\\b\\d{3} \\d{3} \\d{3}\\b/g,\n\t[PIIEntity.AU_TFN]: /\\b\\d{9}\\b/g,\n\t[PIIEntity.AU_MEDICARE]: /\\b\\d{4} \\d{5} \\d{1}\\b/g,\n\n\t// India\n\t[PIIEntity.IN_PAN]: /\\b[A-Z]{5}\\d{4}[A-Z]\\b/g,\n\t[PIIEntity.IN_AADHAAR]: /\\b\\d{4} \\d{4} \\d{4}\\b/g,\n\t[PIIEntity.IN_VEHICLE_REGISTRATION]: /\\b[A-Z]{2}\\d{2}[A-Z]{2}\\d{4}\\b/g,\n\t[PIIEntity.IN_VOTER]: /\\b[A-Z]{3}\\d{7}\\b/g,\n\t[PIIEntity.IN_PASSPORT]: /\\b[A-Z]\\d{7}\\b/g,\n\n\t// Finland\n\t[PIIEntity.FI_PERSONAL_IDENTITY_CODE]: /\\b\\d{6}[+-A]\\d{3}[A-Z0-9]\\b/g,\n};\n\n/**\n * Run regex analysis and collect findings by entity type.\n *\n * @param text The text to analyze for PII\n * @param config PII detection configuration\n * @returns Object containing mapping of entities to detected snippets\n * @throws Error if text is empty or null\n */\nfunction detectPii(text: string, config: PIIConfig): PiiDetectionResult {\n\tif (!text) {\n\t\treturn {\n\t\t\tmapping: {},\n\t\t\tanalyzerResults: [],\n\t\t};\n\t}\n\n\tconst grouped: Record<string, string[]> = {};\n\tconst analyzerResults: PiiAnalyzerResult[] = [];\n\n\tconst matchAgainstPattern = (name: string, pattern: RegExp) => {\n\t\t// make sure to add the global flag to the regex, otherwise while() will never end\n\t\tconst flags = pattern.flags.includes('g') ? pattern.flags : pattern.flags + 'g';\n\t\tconst regex = new RegExp(pattern.source, flags);\n\t\tlet match;\n\t\twhile ((match = regex.exec(text)) !== null) {\n\t\t\tconst entityType = name;\n\t\t\tconst start = match.index;\n\t\t\tconst end = match.index + match[0].length;\n\n\t\t\tif (!grouped[entityType]) {\n\t\t\t\tgrouped[entityType] = [];\n\t\t\t}\n\t\t\tgrouped[entityType].push(text.substring(start, end));\n\n\t\t\tanalyzerResults.push({\n\t\t\t\tentityType,\n\t\t\t\ttext: text.substring(start, end),\n\t\t\t});\n\t\t}\n\t};\n\n\t// Check each configured entity type\n\tconst entities = config.entities ?? allEntities;\n\tfor (const entity of entities) {\n\t\tconst pattern = DEFAULT_PII_PATTERNS[entity];\n\t\tif (pattern) {\n\t\t\tmatchAgainstPattern(entity, pattern);\n\t\t}\n\t}\n\tif (config.customRegex?.length) {\n\t\tfor (const regex of config.customRegex) {\n\t\t\tmatchAgainstPattern(regex.name, parseRegex(regex.value));\n\t\t}\n\t}\n\n\treturn {\n\t\tmapping: grouped,\n\t\tanalyzerResults,\n\t};\n}\n\nexport const createPiiCheckFn: CreateCheckFn<PIIConfig> = (config) => {\n\treturn (input: string) => {\n\t\tconst detection = detectPii(input, config);\n\t\tconst piiFound = detection.mapping && Object.keys(detection.mapping).length > 0;\n\t\treturn {\n\t\t\tguardrailName: 'personalData',\n\t\t\ttripwireTriggered: piiFound,\n\t\t\tinfo: {\n\t\t\t\tmaskEntities: detection.mapping,\n\t\t\t\tanalyzerResults: detection.analyzerResults,\n\t\t\t},\n\t\t};\n\t};\n};\n\nexport const createCustomRegexCheckFn: CreateCheckFn<CustomRegexConfig> = (config) => {\n\treturn (input: string) => {\n\t\tconst detection = detectPii(input, { customRegex: config.customRegex, entities: [] });\n\t\tconst customRegexFound = detection.mapping && Object.keys(detection.mapping).length > 0;\n\t\treturn {\n\t\t\tguardrailName: 'customRegex',\n\t\t\ttripwireTriggered: customRegexFound,\n\t\t\tinfo: {\n\t\t\t\tmaskEntities: detection.mapping,\n\t\t\t\tanalyzerResults: detection.analyzerResults,\n\t\t\t},\n\t\t};\n\t};\n};\n"],"mappings":"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","names":["PIIEntity"]}