{"version":3,"sources":["../../../../../nodes/vendors/Anthropic/transport/index.ts"],"sourcesContent":["import type FormData from 'form-data';\nimport type {\n\tIDataObject,\n\tIExecuteFunctions,\n\tIHttpRequestMethods,\n\tILoadOptionsFunctions,\n} from 'n8n-workflow';\n\ntype RequestParameters = {\n\theaders?: IDataObject;\n\tbody?: IDataObject | string | FormData;\n\tqs?: IDataObject;\n\toption?: IDataObject;\n\tenableAnthropicBetas?: {\n\t\tpromptTools?: boolean;\n\t\tcodeExecution?: boolean;\n\t};\n};\n\nexport async function apiRequest(\n\tthis: IExecuteFunctions | ILoadOptionsFunctions,\n\tmethod: IHttpRequestMethods,\n\tendpoint: string,\n\tparameters?: RequestParameters,\n) {\n\tconst { body, qs, option, headers } = parameters ?? {};\n\n\tconst credentials = await this.getCredentials('anthropicApi');\n\tconst baseUrl = credentials.url ?? 'https://api.anthropic.com';\n\tconst url = `${baseUrl}${endpoint}`;\n\n\tconst betas = ['files-api-2025-04-14'];\n\tif (parameters?.enableAnthropicBetas?.promptTools) {\n\t\tbetas.push('prompt-tools-2025-04-02');\n\t}\n\n\tif (parameters?.enableAnthropicBetas?.codeExecution) {\n\t\tbetas.push('code-execution-2025-05-22');\n\t}\n\n\tconst requestHeaders: IDataObject = {\n\t\t'anthropic-version': '2023-06-01',\n\t\t'anthropic-beta': betas.join(','),\n\t\t...headers,\n\t};\n\n\tif (\n\t\tcredentials.header &&\n\t\ttypeof credentials.headerName === 'string' &&\n\t\tcredentials.headerName &&\n\t\ttypeof credentials.headerValue === 'string'\n\t) {\n\t\trequestHeaders[credentials.headerName] = credentials.headerValue;\n\t}\n\n\tconst options = {\n\t\theaders: requestHeaders,\n\t\tmethod,\n\t\tbody,\n\t\tqs,\n\t\turl,\n\t\tjson: true,\n\t};\n\n\tif (option && Object.keys(option).length !== 0) {\n\t\tObject.assign(options, option);\n\t}\n\n\treturn await this.helpers.httpRequestWithAuthentication.call(this, 'anthropicApi', options);\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAmBA,eAAsB,WAErB,QACA,UACA,YACC;AACD,QAAM,EAAE,MAAM,IAAI,QAAQ,QAAQ,IAAI,cAAc,CAAC;AAErD,QAAM,cAAc,MAAM,KAAK,eAAe,cAAc;AAC5D,QAAM,UAAU,YAAY,OAAO;AACnC,QAAM,MAAM,GAAG,OAAO,GAAG,QAAQ;AAEjC,QAAM,QAAQ,CAAC,sBAAsB;AACrC,MAAI,YAAY,sBAAsB,aAAa;AAClD,UAAM,KAAK,yBAAyB;AAAA,EACrC;AAEA,MAAI,YAAY,sBAAsB,eAAe;AACpD,UAAM,KAAK,2BAA2B;AAAA,EACvC;AAEA,QAAM,iBAA8B;AAAA,IACnC,qBAAqB;AAAA,IACrB,kBAAkB,MAAM,KAAK,GAAG;AAAA,IAChC,GAAG;AAAA,EACJ;AAEA,MACC,YAAY,UACZ,OAAO,YAAY,eAAe,YAClC,YAAY,cACZ,OAAO,YAAY,gBAAgB,UAClC;AACD,mBAAe,YAAY,UAAU,IAAI,YAAY;AAAA,EACtD;AAEA,QAAM,UAAU;AAAA,IACf,SAAS;AAAA,IACT;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA,MAAM;AAAA,EACP;AAEA,MAAI,UAAU,OAAO,KAAK,MAAM,EAAE,WAAW,GAAG;AAC/C,WAAO,OAAO,SAAS,MAAM;AAAA,EAC9B;AAEA,SAAO,MAAM,KAAK,QAAQ,8BAA8B,KAAK,MAAM,gBAAgB,OAAO;AAC3F;","names":[]}