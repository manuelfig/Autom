import { type ChatHubProvider, type ChatHubLLMProvider, type ChatModelsResponse, type ChatHubConversationsResponse, type ChatHubConversationResponse, type ChatMessageId, type ChatSessionId } from '@n8n/api-types';
import { Logger } from '@n8n/backend-common';
import { ExecutionRepository, User, WorkflowRepository } from '@n8n/db';
import type { Response } from 'express';
import { ActiveExecutions } from '../../active-executions';
import { CredentialsFinderService } from '../../credentials/credentials-finder.service';
import { ExecutionService } from '../../executions/execution.service';
import { DynamicNodeParametersService } from '../../services/dynamic-node-parameters.service';
import { WorkflowExecutionService } from '../../workflows/workflow-execution.service';
import { WorkflowFinderService } from '../../workflows/workflow-finder.service';
import { WorkflowService } from '../../workflows/workflow.service';
import { ChatHubAgentService } from './chat-hub-agent.service';
import { ChatHubCredentialsService } from './chat-hub-credentials.service';
import { ChatHubWorkflowService } from './chat-hub-workflow.service';
import type { HumanMessagePayload, RegenerateMessagePayload, EditMessagePayload } from './chat-hub.types';
import { ChatHubMessageRepository } from './chat-message.repository';
import { ChatHubSessionRepository } from './chat-session.repository';
export declare class ChatHubService {
    private readonly logger;
    private readonly executionService;
    private readonly nodeParametersService;
    private readonly executionRepository;
    private readonly workflowExecutionService;
    private readonly workflowService;
    private readonly workflowFinderService;
    private readonly workflowRepository;
    private readonly activeExecutions;
    private readonly sessionRepository;
    private readonly messageRepository;
    private readonly credentialsFinderService;
    private readonly chatHubAgentService;
    private readonly chatHubCredentialsService;
    private readonly chatHubWorkflowService;
    constructor(logger: Logger, executionService: ExecutionService, nodeParametersService: DynamicNodeParametersService, executionRepository: ExecutionRepository, workflowExecutionService: WorkflowExecutionService, workflowService: WorkflowService, workflowFinderService: WorkflowFinderService, workflowRepository: WorkflowRepository, activeExecutions: ActiveExecutions, sessionRepository: ChatHubSessionRepository, messageRepository: ChatHubMessageRepository, credentialsFinderService: CredentialsFinderService, chatHubAgentService: ChatHubAgentService, chatHubCredentialsService: ChatHubCredentialsService, chatHubWorkflowService: ChatHubWorkflowService);
    getModels(user: User, credentialIds: Record<ChatHubLLMProvider, string | null>): Promise<ChatModelsResponse>;
    private fetchModelsForProvider;
    private fetchOpenAiModels;
    private fetchAnthropicModels;
    private fetchGoogleModels;
    private fetchAgentWorkflowsAsModels;
    private deleteChatWorkflow;
    private getErrorMessage;
    private getAIOutput;
    private pickCredentialId;
    sendHumanMessage(res: Response, user: User, payload: HumanMessagePayload): Promise<void>;
    editMessage(res: Response, user: User, payload: EditMessagePayload): Promise<void>;
    regenerateAIMessage(res: Response, user: User, payload: RegenerateMessagePayload): Promise<void>;
    private prepareBaseChatWorkflow;
    private prepareChatAgentWorkflow;
    private prepareCustomAgentWorkflow;
    private ensurePreviousMessage;
    stopGeneration(user: User, sessionId: ChatSessionId, messageId: ChatMessageId): Promise<void>;
    private executeChatWorkflow;
    private executeChatWorkflowWithCleanup;
    private generateSessionTitle;
    private prepareTitleGenerationWorkflow;
    private resolveCredentialsAndModelForTitle;
    private resolveFromN8nWorkflow;
    private findSupportedLLMNodes;
    private resolveFromCustomAgent;
    private runTitleWorkflowAndGetTitle;
    private saveHumanMessage;
    private saveAIMessage;
    private getModelWithCredentials;
    private getChatSession;
    private getChatMessage;
    getConversations(userId: string): Promise<ChatHubConversationsResponse>;
    getConversation(userId: string, sessionId: string): Promise<ChatHubConversationResponse>;
    private convertMessageToDto;
    private buildMessageHistory;
    deleteAllSessions(): Promise<import("@n8n/typeorm").DeleteResult>;
    updateSessionTitle(userId: string, sessionId: ChatSessionId, title: string): Promise<import("./chat-hub-session.entity").ChatHubSession>;
    updateSession(user: User, sessionId: ChatSessionId, updates: {
        title?: string;
        credentialId?: string | null;
        provider?: ChatHubProvider;
        model?: string | null;
        workflowId?: string | null;
        agentId?: string | null;
        agentName?: string | null;
    }): Promise<import("./chat-hub-session.entity").ChatHubSession>;
    deleteSession(userId: string, sessionId: ChatSessionId): Promise<void>;
}
